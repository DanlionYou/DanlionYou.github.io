import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,a as l,o as e}from"./app-BF0hwt7B.js";const n={};function t(h,s){return e(),a("div",null,s[0]||(s[0]=[l(`<h2 id="å›é¡¾ä¸€ä¸‹ç±»åŠ è½½è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#å›é¡¾ä¸€ä¸‹ç±»åŠ è½½è¿‡ç¨‹"><span>å›é¡¾ä¸€ä¸‹ç±»åŠ è½½è¿‡ç¨‹</span></a></h2><p>å¼€å§‹ä»‹ç»ç±»åŠ è½½å™¨å’ŒåŒäº²å§”æ´¾æ¨¡å‹ä¹‹å‰ï¼Œç®€å•å›é¡¾ä¸€ä¸‹ç±»åŠ è½½è¿‡ç¨‹ã€‚</p><ul><li>ç±»åŠ è½½è¿‡ç¨‹ï¼š<strong>åŠ è½½-&gt;è¿æ¥-&gt;åˆå§‹åŒ–</strong>ã€‚</li><li>è¿æ¥è¿‡ç¨‹åˆå¯åˆ†ä¸ºä¸‰æ­¥ï¼š<strong>éªŒè¯-&gt;å‡†å¤‡-&gt;è§£æ</strong>ã€‚</li></ul><p><img src="https://oss.javaguide.cn/github/javaguide/java/jvm/class-loading-procedure.png" alt="ç±»åŠ è½½è¿‡ç¨‹"></p><p>åŠ è½½æ˜¯ç±»åŠ è½½è¿‡ç¨‹çš„ç¬¬ä¸€æ­¥ï¼Œä¸»è¦å®Œæˆä¸‹é¢ 3 ä»¶äº‹æƒ…ï¼š</p><ol><li>é€šè¿‡å…¨ç±»åè·å–å®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµ</li><li>å°†å­—èŠ‚æµæ‰€ä»£è¡¨çš„é™æ€å­˜å‚¨ç»“æ„è½¬æ¢ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„</li><li>åœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¯¥ç±»çš„ <code>Class</code> å¯¹è±¡ï¼Œä½œä¸ºæ–¹æ³•åŒºè¿™äº›æ•°æ®çš„è®¿é—®å…¥å£</li></ol><h2 id="ç±»åŠ è½½å™¨" tabindex="-1"><a class="header-anchor" href="#ç±»åŠ è½½å™¨"><span>ç±»åŠ è½½å™¨</span></a></h2><h3 id="ç±»åŠ è½½å™¨ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#ç±»åŠ è½½å™¨ä»‹ç»"><span>ç±»åŠ è½½å™¨ä»‹ç»</span></a></h3><p>ç±»åŠ è½½å™¨ä» JDK 1.0 å°±å‡ºç°äº†ï¼Œæœ€åˆåªæ˜¯ä¸ºäº†æ»¡è¶³ Java Appletï¼ˆå·²ç»è¢«æ·˜æ±°ï¼‰ çš„éœ€è¦ã€‚åæ¥ï¼Œæ…¢æ…¢æˆä¸º Java ç¨‹åºä¸­çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ï¼Œèµ‹äºˆäº† Java ç±»å¯ä»¥è¢«åŠ¨æ€åŠ è½½åˆ° JVM ä¸­å¹¶æ‰§è¡Œçš„èƒ½åŠ›ã€‚</p><p>æ ¹æ®å®˜æ–¹ API æ–‡æ¡£çš„ä»‹ç»ï¼š</p><blockquote><p>A class loader is an object that is responsible for loading classes. The class ClassLoader is an abstract class. Given the binary name of a class, a class loader should attempt to locate or generate data that constitutes a definition for the class. A typical strategy is to transform the name into a file name and then read a &quot;class file&quot; of that name from a file system.</p><p>Every Class object contains a reference to the ClassLoader that defined it.</p><p>Class objects for array classes are not created by class loaders, but are created automatically as required by the Java runtime. The class loader for an array class, as returned by Class.getClassLoader() is the same as the class loader for its element type; if the element type is a primitive type, then the array class has no class loader.</p></blockquote><p>ç¿»è¯‘è¿‡æ¥å¤§æ¦‚çš„æ„æ€æ˜¯ï¼š</p><blockquote><p>ç±»åŠ è½½å™¨æ˜¯ä¸€ä¸ªè´Ÿè´£åŠ è½½ç±»çš„å¯¹è±¡ã€‚<code>ClassLoader</code> æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ã€‚ç»™å®šç±»çš„äºŒè¿›åˆ¶åç§°ï¼Œç±»åŠ è½½å™¨åº”å°è¯•å®šä½æˆ–ç”Ÿæˆæ„æˆç±»å®šä¹‰çš„æ•°æ®ã€‚å…¸å‹çš„ç­–ç•¥æ˜¯å°†åç§°è½¬æ¢ä¸ºæ–‡ä»¶åï¼Œç„¶åä»æ–‡ä»¶ç³»ç»Ÿä¸­è¯»å–è¯¥åç§°çš„â€œç±»æ–‡ä»¶â€ã€‚</p><p>æ¯ä¸ª Java ç±»éƒ½æœ‰ä¸€ä¸ªå¼•ç”¨æŒ‡å‘åŠ è½½å®ƒçš„ <code>ClassLoader</code>ã€‚ä¸è¿‡ï¼Œæ•°ç»„ç±»ä¸æ˜¯é€šè¿‡ <code>ClassLoader</code> åˆ›å»ºçš„ï¼Œè€Œæ˜¯ JVM åœ¨éœ€è¦çš„æ—¶å€™è‡ªåŠ¨åˆ›å»ºçš„ï¼Œæ•°ç»„ç±»é€šè¿‡<code>getClassLoader()</code>æ–¹æ³•è·å– <code>ClassLoader</code> çš„æ—¶å€™å’Œè¯¥æ•°ç»„çš„å…ƒç´ ç±»å‹çš„ <code>ClassLoader</code> æ˜¯ä¸€è‡´çš„ã€‚</p></blockquote><p>ä»ä¸Šé¢çš„ä»‹ç»å¯ä»¥çœ‹å‡º:</p><ul><li>ç±»åŠ è½½å™¨æ˜¯ä¸€ä¸ªè´Ÿè´£åŠ è½½ç±»çš„å¯¹è±¡ï¼Œç”¨äºå®ç°ç±»åŠ è½½è¿‡ç¨‹ä¸­çš„åŠ è½½è¿™ä¸€æ­¥ã€‚</li><li>æ¯ä¸ª Java ç±»éƒ½æœ‰ä¸€ä¸ªå¼•ç”¨æŒ‡å‘åŠ è½½å®ƒçš„ <code>ClassLoader</code>ã€‚</li><li>æ•°ç»„ç±»ä¸æ˜¯é€šè¿‡ <code>ClassLoader</code> åˆ›å»ºçš„ï¼ˆæ•°ç»„ç±»æ²¡æœ‰å¯¹åº”çš„äºŒè¿›åˆ¶å­—èŠ‚æµï¼‰ï¼Œæ˜¯ç”± JVM ç›´æ¥ç”Ÿæˆçš„ã€‚</li></ul><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Class</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">T</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  ...</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> final</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> ClassLoader</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> classLoader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">CallerSensitive</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> ClassLoader</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getClassLoader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     //...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  ...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç®€å•æ¥è¯´ï¼Œ<strong>ç±»åŠ è½½å™¨çš„ä¸»è¦ä½œç”¨å°±æ˜¯åŠ¨æ€åŠ è½½ Java ç±»çš„å­—èŠ‚ç ï¼ˆ <code>.class</code> æ–‡ä»¶ï¼‰åˆ° JVM ä¸­ï¼ˆåœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¯¥ç±»çš„ <code>Class</code> å¯¹è±¡ï¼‰ã€‚</strong> å­—èŠ‚ç å¯ä»¥æ˜¯ Java æºç¨‹åºï¼ˆ<code>.java</code>æ–‡ä»¶ï¼‰ç»è¿‡ <code>javac</code> ç¼–è¯‘å¾—æ¥ï¼Œä¹Ÿå¯ä»¥æ˜¯é€šè¿‡å·¥å…·åŠ¨æ€ç”Ÿæˆæˆ–è€…é€šè¿‡ç½‘ç»œä¸‹è½½å¾—æ¥ã€‚</p><p>å…¶å®é™¤äº†åŠ è½½ç±»ä¹‹å¤–ï¼Œç±»åŠ è½½å™¨è¿˜å¯ä»¥åŠ è½½ Java åº”ç”¨æ‰€éœ€çš„èµ„æºå¦‚æ–‡æœ¬ã€å›¾åƒã€é…ç½®æ–‡ä»¶ã€è§†é¢‘ç­‰ç­‰æ–‡ä»¶èµ„æºã€‚æœ¬æ–‡åªè®¨è®ºå…¶æ ¸å¿ƒåŠŸèƒ½ï¼šåŠ è½½ç±»ã€‚</p><h3 id="ç±»åŠ è½½å™¨åŠ è½½è§„åˆ™" tabindex="-1"><a class="header-anchor" href="#ç±»åŠ è½½å™¨åŠ è½½è§„åˆ™"><span>ç±»åŠ è½½å™¨åŠ è½½è§„åˆ™</span></a></h3><p>JVM å¯åŠ¨çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰çš„ç±»ï¼Œè€Œæ˜¯æ ¹æ®éœ€è¦å»åŠ¨æ€åŠ è½½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¤§éƒ¨åˆ†ç±»åœ¨å…·ä½“ç”¨åˆ°çš„æ—¶å€™æ‰ä¼šå»åŠ è½½ï¼Œè¿™æ ·å¯¹å†…å­˜æ›´åŠ å‹å¥½ã€‚</p><p>å¯¹äºå·²ç»åŠ è½½çš„ç±»ä¼šè¢«æ”¾åœ¨ <code>ClassLoader</code> ä¸­ã€‚åœ¨ç±»åŠ è½½çš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šé¦–å…ˆåˆ¤æ–­å½“å‰ç±»æ˜¯å¦è¢«åŠ è½½è¿‡ã€‚å·²ç»è¢«åŠ è½½çš„ç±»ä¼šç›´æ¥è¿”å›ï¼Œå¦åˆ™æ‰ä¼šå°è¯•åŠ è½½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºä¸€ä¸ªç±»åŠ è½½å™¨æ¥è¯´ï¼Œç›¸åŒäºŒè¿›åˆ¶åç§°çš„ç±»åªä¼šè¢«åŠ è½½ä¸€æ¬¡ã€‚</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> abstract</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> ClassLoader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  ...</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> final</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> ClassLoader</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> parent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // ç”±è¿™ä¸ªç±»åŠ è½½å™¨åŠ è½½çš„ç±»ã€‚</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> final</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Vector</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Class</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD;">?</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">&gt;&gt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> classes </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Vector</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // ç”±VMè°ƒç”¨ï¼Œç”¨æ­¤ç±»åŠ è½½å™¨è®°å½•æ¯ä¸ªå·²åŠ è½½ç±»ã€‚</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> addClass</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD;">?</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        classes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">addElement</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(c);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  ...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç±»åŠ è½½å™¨æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#ç±»åŠ è½½å™¨æ€»ç»“"><span>ç±»åŠ è½½å™¨æ€»ç»“</span></a></h3><p>JVM ä¸­å†…ç½®äº†ä¸‰ä¸ªé‡è¦çš„ <code>ClassLoader</code>ï¼š</p><ol><li><strong><code>BootstrapClassLoader</code>(å¯åŠ¨ç±»åŠ è½½å™¨)</strong>ï¼šæœ€é¡¶å±‚çš„åŠ è½½ç±»ï¼Œç”± C++å®ç°ï¼Œé€šå¸¸è¡¨ç¤ºä¸º nullï¼Œå¹¶ä¸”æ²¡æœ‰çˆ¶çº§ï¼Œä¸»è¦ç”¨æ¥åŠ è½½ JDK å†…éƒ¨çš„æ ¸å¿ƒç±»åº“ï¼ˆ <code>%JAVA_HOME%/lib</code>ç›®å½•ä¸‹çš„ <code>rt.jar</code>ã€<code>resources.jar</code>ã€<code>charsets.jar</code>ç­‰ jar åŒ…å’Œç±»ï¼‰ä»¥åŠè¢« <code>-Xbootclasspath</code>å‚æ•°æŒ‡å®šçš„è·¯å¾„ä¸‹çš„æ‰€æœ‰ç±»ã€‚</li><li><strong><code>ExtensionClassLoader</code>(æ‰©å±•ç±»åŠ è½½å™¨)</strong>ï¼šä¸»è¦è´Ÿè´£åŠ è½½ <code>%JRE_HOME%/lib/ext</code> ç›®å½•ä¸‹çš„ jar åŒ…å’Œç±»ä»¥åŠè¢« <code>java.ext.dirs</code> ç³»ç»Ÿå˜é‡æ‰€æŒ‡å®šçš„è·¯å¾„ä¸‹çš„æ‰€æœ‰ç±»ã€‚</li><li><strong><code>AppClassLoader</code>(åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨)</strong>ï¼šé¢å‘æˆ‘ä»¬ç”¨æˆ·çš„åŠ è½½å™¨ï¼Œè´Ÿè´£åŠ è½½å½“å‰åº”ç”¨ classpath ä¸‹çš„æ‰€æœ‰ jar åŒ…å’Œç±»ã€‚</li></ol><blockquote><p>ğŸŒˆ æ‹“å±•ä¸€ä¸‹ï¼š</p><ul><li><strong><code>rt.jar</code></strong>ï¼šrt ä»£è¡¨â€œRunTimeâ€ï¼Œ<code>rt.jar</code>æ˜¯ Java åŸºç¡€ç±»åº“ï¼ŒåŒ…å« Java doc é‡Œé¢çœ‹åˆ°çš„æ‰€æœ‰çš„ç±»çš„ç±»æ–‡ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¸¸ç”¨å†…ç½®åº“ <code>java.xxx.*</code>éƒ½åœ¨é‡Œé¢ï¼Œæ¯”å¦‚<code>java.util.*</code>ã€<code>java.io.*</code>ã€<code>java.nio.*</code>ã€<code>java.lang.*</code>ã€<code>java.sql.*</code>ã€<code>java.math.*</code>ã€‚</li><li>Java 9 å¼•å…¥äº†æ¨¡å—ç³»ç»Ÿï¼Œå¹¶ä¸”ç•¥å¾®æ›´æ”¹äº†ä¸Šè¿°çš„ç±»åŠ è½½å™¨ã€‚æ‰©å±•ç±»åŠ è½½å™¨è¢«æ”¹åä¸ºå¹³å°ç±»åŠ è½½å™¨ï¼ˆplatform class loaderï¼‰ã€‚Java SE ä¸­é™¤äº†å°‘æ•°å‡ ä¸ªå…³é”®æ¨¡å—ï¼Œæ¯”å¦‚è¯´ <code>java.base</code> æ˜¯ç”±å¯åŠ¨ç±»åŠ è½½å™¨åŠ è½½ä¹‹å¤–ï¼Œå…¶ä»–çš„æ¨¡å—å‡ç”±å¹³å°ç±»åŠ è½½å™¨æ‰€åŠ è½½ã€‚</li></ul></blockquote><p>é™¤äº†è¿™ä¸‰ç§ç±»åŠ è½½å™¨ä¹‹å¤–ï¼Œç”¨æˆ·è¿˜å¯ä»¥åŠ å…¥è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨æ¥è¿›è¡Œæ‹“å±•ï¼Œä»¥æ»¡è¶³è‡ªå·±çš„ç‰¹æ®Šéœ€æ±‚ã€‚å°±æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ Java ç±»çš„å­—èŠ‚ç ï¼ˆ <code>.class</code> æ–‡ä»¶ï¼‰è¿›è¡ŒåŠ å¯†ï¼ŒåŠ è½½æ—¶å†åˆ©ç”¨è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨å¯¹å…¶è§£å¯†ã€‚</p><p><img src="https://oss.javaguide.cn/github/javaguide/java/jvm/class-loader-parents-delegation-model.png" alt="ç±»åŠ è½½å™¨å±‚æ¬¡å…³ç³»å›¾"></p><p>é™¤äº† <code>BootstrapClassLoader</code> æ˜¯ JVM è‡ªèº«çš„ä¸€éƒ¨åˆ†ä¹‹å¤–ï¼Œå…¶ä»–æ‰€æœ‰çš„ç±»åŠ è½½å™¨éƒ½æ˜¯åœ¨ JVM å¤–éƒ¨å®ç°çš„ï¼Œå¹¶ä¸”å…¨éƒ½ç»§æ‰¿è‡ª <code>ClassLoader</code>æŠ½è±¡ç±»ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼Œä»¥ä¾¿è®©åº”ç”¨ç¨‹åºè‡ªå·±å†³å®šå¦‚ä½•å»è·å–æ‰€éœ€çš„ç±»ã€‚</p><p>æ¯ä¸ª <code>ClassLoader</code> å¯ä»¥é€šè¿‡<code>getParent()</code>è·å–å…¶çˆ¶ <code>ClassLoader</code>ï¼Œå¦‚æœè·å–åˆ° <code>ClassLoader</code> ä¸º<code>null</code>çš„è¯ï¼Œé‚£ä¹ˆè¯¥ç±»æ˜¯é€šè¿‡ <code>BootstrapClassLoader</code> åŠ è½½çš„ã€‚</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> abstract</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> ClassLoader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  ...</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // çˆ¶åŠ è½½å™¨</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> final</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> ClassLoader</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> parent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">CallerSensitive</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> final</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> ClassLoader</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getParent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     //...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  ...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä¸ºä»€ä¹ˆ è·å–åˆ° <code>ClassLoader</code> ä¸º<code>null</code>å°±æ˜¯ <code>BootstrapClassLoader</code> åŠ è½½çš„å‘¢ï¼Ÿ</strong> è¿™æ˜¯å› ä¸º<code>BootstrapClassLoader</code> ç”± C++ å®ç°ï¼Œç”±äºè¿™ä¸ª C++ å®ç°çš„ç±»åŠ è½½å™¨åœ¨ Java ä¸­æ˜¯æ²¡æœ‰ä¸ä¹‹å¯¹åº”çš„ç±»çš„ï¼Œæ‰€ä»¥æ‹¿åˆ°çš„ç»“æœæ˜¯ nullã€‚</p><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªè·å– <code>ClassLoader</code> çš„å°æ¡ˆä¾‹ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> PrintClassLoaderTree</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[] </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">args</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">        ClassLoader</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> classLoader</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> PrintClassLoaderTree</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getClassLoader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">        StringBuilder</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> split</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> StringBuilder</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;|--&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        boolean</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> needContinue</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        while</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (needContinue){</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">            System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">split</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> classLoader);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(classLoader </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">){</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                needContinue </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> false</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            }</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                classLoader </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> classLoader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getParent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">                split</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">insert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\t</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¾“å‡ºç»“æœ(JDK 8 )ï¼š</p><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" data-title="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>|--sun.misc.Launcher$AppClassLoader@18b4aac2</span></span>
<span class="line"><span>    |--sun.misc.Launcher$ExtClassLoader@53bd815b</span></span>
<span class="line"><span>        |--null</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»è¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºï¼š</p><ul><li>æˆ‘ä»¬ç¼–å†™çš„ Java ç±» <code>PrintClassLoaderTree</code> çš„ <code>ClassLoader</code> æ˜¯<code>AppClassLoader</code>ï¼›</li><li><code>AppClassLoader</code>çš„çˆ¶ <code>ClassLoader</code> æ˜¯<code>ExtClassLoader</code>ï¼›</li><li><code>ExtClassLoader</code>çš„çˆ¶<code>ClassLoader</code>æ˜¯<code>Bootstrap ClassLoader</code>ï¼Œå› æ­¤è¾“å‡ºç»“æœä¸º nullã€‚</li></ul><h3 id="è‡ªå®šä¹‰ç±»åŠ è½½å™¨" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰ç±»åŠ è½½å™¨"><span>è‡ªå®šä¹‰ç±»åŠ è½½å™¨</span></a></h3><p>æˆ‘ä»¬å‰é¢ä¹Ÿè¯´è¯´äº†ï¼Œé™¤äº† <code>BootstrapClassLoader</code> å…¶ä»–ç±»åŠ è½½å™¨å‡ç”± Java å®ç°ä¸”å…¨éƒ¨ç»§æ‰¿è‡ª<code>java.lang.ClassLoader</code>ã€‚å¦‚æœæˆ‘ä»¬è¦è‡ªå®šä¹‰è‡ªå·±çš„ç±»åŠ è½½å™¨ï¼Œå¾ˆæ˜æ˜¾éœ€è¦ç»§æ‰¿ <code>ClassLoader</code>æŠ½è±¡ç±»ã€‚</p><p><code>ClassLoader</code> ç±»æœ‰ä¸¤ä¸ªå…³é”®çš„æ–¹æ³•ï¼š</p><ul><li><code>protected Class loadClass(String name, boolean resolve)</code>ï¼šåŠ è½½æŒ‡å®šäºŒè¿›åˆ¶åç§°çš„ç±»ï¼Œå®ç°äº†åŒäº²å§”æ´¾æœºåˆ¶ ã€‚<code>name</code> ä¸ºç±»çš„äºŒè¿›åˆ¶åç§°ï¼Œ<code>resolve</code> å¦‚æœä¸º trueï¼Œåœ¨åŠ è½½æ—¶è°ƒç”¨ <code>resolveClass(Class&lt;?&gt; c)</code> æ–¹æ³•è§£æè¯¥ç±»ã€‚</li><li><code>protected Class findClass(String name)</code>ï¼šæ ¹æ®ç±»çš„äºŒè¿›åˆ¶åç§°æ¥æŸ¥æ‰¾ç±»ï¼Œé»˜è®¤å®ç°æ˜¯ç©ºæ–¹æ³•ã€‚</li></ul><p>å®˜æ–¹ API æ–‡æ¡£ä¸­å†™åˆ°ï¼š</p><blockquote><p>Subclasses of <code>ClassLoader</code> are encouraged to override <code>findClass(String name)</code>, rather than this method.</p><p>å»ºè®® <code>ClassLoader</code>çš„å­ç±»é‡å†™ <code>findClass(String name)</code>æ–¹æ³•è€Œä¸æ˜¯<code>loadClass(String name, boolean resolve)</code> æ–¹æ³•ã€‚</p></blockquote><p>å¦‚æœæˆ‘ä»¬ä¸æƒ³æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹ï¼Œå°±é‡å†™ <code>ClassLoader</code> ç±»ä¸­çš„ <code>findClass()</code> æ–¹æ³•å³å¯ï¼Œæ— æ³•è¢«çˆ¶ç±»åŠ è½½å™¨åŠ è½½çš„ç±»æœ€ç»ˆä¼šé€šè¿‡è¿™ä¸ªæ–¹æ³•è¢«åŠ è½½ã€‚ä½†æ˜¯ï¼Œå¦‚æœæƒ³æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹åˆ™éœ€è¦é‡å†™ <code>loadClass()</code> æ–¹æ³•ã€‚</p><h2 id="åŒäº²å§”æ´¾æ¨¡å‹" tabindex="-1"><a class="header-anchor" href="#åŒäº²å§”æ´¾æ¨¡å‹"><span>åŒäº²å§”æ´¾æ¨¡å‹</span></a></h2><h3 id="åŒäº²å§”æ´¾æ¨¡å‹ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#åŒäº²å§”æ´¾æ¨¡å‹ä»‹ç»"><span>åŒäº²å§”æ´¾æ¨¡å‹ä»‹ç»</span></a></h3><p>ç±»åŠ è½½å™¨æœ‰å¾ˆå¤šç§ï¼Œå½“æˆ‘ä»¬æƒ³è¦åŠ è½½ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œå…·ä½“æ˜¯å“ªä¸ªç±»åŠ è½½å™¨åŠ è½½å‘¢ï¼Ÿè¿™å°±éœ€è¦æåˆ°åŒäº²å§”æ´¾æ¨¡å‹äº†ã€‚</p><p>æ ¹æ®å®˜ç½‘ä»‹ç»ï¼š</p><blockquote><p>The ClassLoader class uses a delegation model to search for classes and resources. Each instance of ClassLoader has an associated parent class loader. When requested to find a class or resource, a ClassLoader instance will delegate the search for the class or resource to its parent class loader before attempting to find the class or resource itself. The virtual machine&#39;s built-in class loader, called the &quot;bootstrap class loader&quot;, does not itself have a parent but may serve as the parent of a ClassLoader instance.</p></blockquote><p>ç¿»è¯‘è¿‡æ¥å¤§æ¦‚çš„æ„æ€æ˜¯ï¼š</p><blockquote><p><code>ClassLoader</code> ç±»ä½¿ç”¨å§”æ‰˜æ¨¡å‹æ¥æœç´¢ç±»å’Œèµ„æºã€‚æ¯ä¸ª <code>ClassLoader</code> å®ä¾‹éƒ½æœ‰ä¸€ä¸ªç›¸å…³çš„çˆ¶ç±»åŠ è½½å™¨ã€‚éœ€è¦æŸ¥æ‰¾ç±»æˆ–èµ„æºæ—¶ï¼Œ<code>ClassLoader</code> å®ä¾‹ä¼šåœ¨è¯•å›¾äº²è‡ªæŸ¥æ‰¾ç±»æˆ–èµ„æºä¹‹å‰ï¼Œå°†æœç´¢ç±»æˆ–èµ„æºçš„ä»»åŠ¡å§”æ‰˜ç»™å…¶çˆ¶ç±»åŠ è½½å™¨ã€‚<br> è™šæ‹Ÿæœºä¸­è¢«ç§°ä¸º &quot;bootstrap class loader&quot;çš„å†…ç½®ç±»åŠ è½½å™¨æœ¬èº«æ²¡æœ‰çˆ¶ç±»åŠ è½½å™¨ï¼Œä½†æ˜¯å¯ä»¥ä½œä¸º <code>ClassLoader</code> å®ä¾‹çš„çˆ¶ç±»åŠ è½½å™¨ã€‚</p></blockquote><p>ä»ä¸Šé¢çš„ä»‹ç»å¯ä»¥çœ‹å‡ºï¼š</p><ul><li><code>ClassLoader</code> ç±»ä½¿ç”¨å§”æ‰˜æ¨¡å‹æ¥æœç´¢ç±»å’Œèµ„æºã€‚</li><li>åŒäº²å§”æ´¾æ¨¡å‹è¦æ±‚é™¤äº†é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨å¤–ï¼Œå…¶ä½™çš„ç±»åŠ è½½å™¨éƒ½åº”æœ‰è‡ªå·±çš„çˆ¶ç±»åŠ è½½å™¨ã€‚</li><li><code>ClassLoader</code> å®ä¾‹ä¼šåœ¨è¯•å›¾äº²è‡ªæŸ¥æ‰¾ç±»æˆ–èµ„æºä¹‹å‰ï¼Œå°†æœç´¢ç±»æˆ–èµ„æºçš„ä»»åŠ¡å§”æ‰˜ç»™å…¶çˆ¶ç±»åŠ è½½å™¨ã€‚</li></ul><p>ä¸‹å›¾å±•ç¤ºçš„å„ç§ç±»åŠ è½½å™¨ä¹‹é—´çš„å±‚æ¬¡å…³ç³»è¢«ç§°ä¸ºç±»åŠ è½½å™¨çš„â€œ<strong>åŒäº²å§”æ´¾æ¨¡å‹(Parents Delegation Model)</strong>â€ã€‚</p><p><img src="https://oss.javaguide.cn/github/javaguide/java/jvm/class-loader-parents-delegation-model.png" alt="ç±»åŠ è½½å™¨å±‚æ¬¡å…³ç³»å›¾"></p><p>æ³¨æ„ âš ï¸ï¼šåŒäº²å§”æ´¾æ¨¡å‹å¹¶ä¸æ˜¯ä¸€ç§å¼ºåˆ¶æ€§çš„çº¦æŸï¼Œåªæ˜¯ JDK å®˜æ–¹æ¨èçš„ä¸€ç§æ–¹å¼ã€‚å¦‚æœæˆ‘ä»¬å› ä¸ºæŸäº›ç‰¹æ®Šéœ€æ±‚æƒ³è¦æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œåæ–‡ä¼šä»‹ç»å…·ä½“çš„æ–¹æ³•ã€‚</p><p>å…¶å®è¿™ä¸ªåŒäº²ç¿»è¯‘çš„å®¹æ˜“è®©åˆ«äººè¯¯è§£ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç†è§£çš„åŒäº²éƒ½æ˜¯çˆ¶æ¯ï¼Œè¿™é‡Œçš„åŒäº²æ›´å¤šåœ°è¡¨è¾¾çš„æ˜¯â€œçˆ¶æ¯è¿™ä¸€è¾ˆâ€çš„äººè€Œå·²ï¼Œå¹¶ä¸æ˜¯è¯´çœŸçš„æœ‰ä¸€ä¸ª <code>MotherClassLoader</code> å’Œä¸€ä¸ª<code>FatherClassLoader</code> ã€‚ä¸ªäººè§‰å¾—ç¿»è¯‘æˆå•äº²å§”æ´¾æ¨¡å‹æ›´å¥½ä¸€äº›ï¼Œä¸è¿‡ï¼Œå›½å†…æ—¢ç„¶ç¿»è¯‘æˆäº†åŒäº²å§”æ´¾æ¨¡å‹å¹¶æµä¼ äº†ï¼ŒæŒ‰ç…§è¿™ä¸ªæ¥ä¹Ÿæ²¡é—®é¢˜ï¼Œä¸è¦è¢«è¯¯è§£äº†å°±å¥½ã€‚</p><p>å¦å¤–ï¼Œç±»åŠ è½½å™¨ä¹‹é—´çš„çˆ¶å­å…³ç³»ä¸€èˆ¬ä¸æ˜¯ä»¥ç»§æ‰¿çš„å…³ç³»æ¥å®ç°çš„ï¼Œè€Œæ˜¯é€šå¸¸ä½¿ç”¨ç»„åˆå…³ç³»æ¥å¤ç”¨çˆ¶åŠ è½½å™¨çš„ä»£ç ã€‚</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> abstract</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> ClassLoader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  ...</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // ç»„åˆ</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> final</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> ClassLoader</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> parent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  protected</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> ClassLoader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">ClassLoader</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> parent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">       this</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">checkCreateClassLoader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(), parent);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  ...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œæœ‰ä¸€æ¡éå¸¸ç»å…¸çš„è®¾è®¡åŸåˆ™ï¼š<strong>ç»„åˆä¼˜äºç»§æ‰¿ï¼Œå¤šç”¨ç»„åˆå°‘ç”¨ç»§æ‰¿ã€‚</strong></p><h3 id="åŒäº²å§”æ´¾æ¨¡å‹çš„æ‰§è¡Œæµç¨‹" tabindex="-1"><a class="header-anchor" href="#åŒäº²å§”æ´¾æ¨¡å‹çš„æ‰§è¡Œæµç¨‹"><span>åŒäº²å§”æ´¾æ¨¡å‹çš„æ‰§è¡Œæµç¨‹</span></a></h3><p>åŒäº²å§”æ´¾æ¨¡å‹çš„å®ç°ä»£ç éå¸¸ç®€å•ï¼Œé€»è¾‘éå¸¸æ¸…æ™°ï¼Œéƒ½é›†ä¸­åœ¨ <code>java.lang.ClassLoader</code> çš„ <code>loadClass()</code> ä¸­ï¼Œç›¸å…³ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">protected</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Class</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">?</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> loadClass</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> boolean</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> resolve)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    throws </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">ClassNotFoundException</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    synchronized</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getClassLoadingLock</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(name)) {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        //é¦–å…ˆï¼Œæ£€æŸ¥è¯¥ç±»æ˜¯å¦å·²ç»åŠ è½½è¿‡</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">        Class</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> c </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> findLoadedClass</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(name)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> (c </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            //å¦‚æœ c ä¸º nullï¼Œåˆ™è¯´æ˜è¯¥ç±»æ²¡æœ‰è¢«åŠ è½½è¿‡</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            long</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> t0 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nanoTime</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            try</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                if</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> (parent </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    //å½“çˆ¶ç±»çš„åŠ è½½å™¨ä¸ä¸ºç©ºï¼Œåˆ™é€šè¿‡çˆ¶ç±»çš„loadClassæ¥åŠ è½½è¯¥ç±»</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">                    c </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> parent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">loadClass</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(name, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">                } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    //å½“çˆ¶ç±»çš„åŠ è½½å™¨ä¸ºç©ºï¼Œåˆ™è°ƒç”¨å¯åŠ¨ç±»åŠ è½½å™¨æ¥åŠ è½½è¯¥ç±»</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">                    c </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> findBootstrapClassOrNull</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(name)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">                }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">            } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">ClassNotFoundException</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> e</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                //éç©ºçˆ¶ç±»çš„ç±»åŠ è½½å™¨æ— æ³•æ‰¾åˆ°ç›¸åº”çš„ç±»ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            if</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> (c </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                //å½“çˆ¶ç±»åŠ è½½å™¨æ— æ³•åŠ è½½æ—¶ï¼Œåˆ™è°ƒç”¨findClassæ–¹æ³•æ¥åŠ è½½è¯¥ç±»</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                //ç”¨æˆ·å¯é€šè¿‡è¦†å†™è¯¥æ–¹æ³•ï¼Œæ¥è‡ªå®šä¹‰ç±»åŠ è½½å™¨</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                long</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> t1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nanoTime</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">                c </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> findClass</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(name)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                //ç”¨äºç»Ÿè®¡ç±»åŠ è½½å™¨ç›¸å…³çš„ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">                sun</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">misc</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">PerfCounter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getParentDelegationTime</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">addTime</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(t1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> t0);</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">                sun</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">misc</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">PerfCounter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getFindClassTime</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">addElapsedTimeFrom</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(t1);</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">                sun</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">misc</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">PerfCounter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getFindClasses</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">increment</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">            }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> (resolve) {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            //å¯¹ç±»è¿›è¡Œlinkæ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">            resolveClass</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(c)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¯å½“ä¸€ä¸ªç±»åŠ è½½å™¨æ¥æ”¶åˆ°åŠ è½½è¯·æ±‚æ—¶ï¼Œå®ƒä¼šå…ˆå°†è¯·æ±‚è½¬å‘ç»™çˆ¶ç±»åŠ è½½å™¨ã€‚åœ¨çˆ¶ç±»åŠ è½½å™¨æ²¡æœ‰æ‰¾åˆ°æ‰€è¯·æ±‚çš„ç±»çš„æƒ…å†µä¸‹ï¼Œè¯¥ç±»åŠ è½½å™¨æ‰ä¼šå°è¯•å»åŠ è½½ã€‚</p><p>ç»“åˆä¸Šé¢çš„æºç ï¼Œç®€å•æ€»ç»“ä¸€ä¸‹åŒäº²å§”æ´¾æ¨¡å‹çš„æ‰§è¡Œæµç¨‹ï¼š</p><ul><li>åœ¨ç±»åŠ è½½çš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šé¦–å…ˆåˆ¤æ–­å½“å‰ç±»æ˜¯å¦è¢«åŠ è½½è¿‡ã€‚å·²ç»è¢«åŠ è½½çš„ç±»ä¼šç›´æ¥è¿”å›ï¼Œå¦åˆ™æ‰ä¼šå°è¯•åŠ è½½ï¼ˆæ¯ä¸ªçˆ¶ç±»åŠ è½½å™¨éƒ½ä¼šèµ°ä¸€éè¿™ä¸ªæµç¨‹ï¼‰ã€‚</li><li>ç±»åŠ è½½å™¨åœ¨è¿›è¡Œç±»åŠ è½½çš„æ—¶å€™ï¼Œå®ƒé¦–å…ˆä¸ä¼šè‡ªå·±å»å°è¯•åŠ è½½è¿™ä¸ªç±»ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªè¯·æ±‚å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨å»å®Œæˆï¼ˆè°ƒç”¨çˆ¶åŠ è½½å™¨ <code>loadClass()</code>æ–¹æ³•æ¥åŠ è½½ç±»ï¼‰ã€‚è¿™æ ·çš„è¯ï¼Œæ‰€æœ‰çš„è¯·æ±‚æœ€ç»ˆéƒ½ä¼šä¼ é€åˆ°é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨ <code>BootstrapClassLoader</code> ä¸­ã€‚</li><li>åªæœ‰å½“çˆ¶åŠ è½½å™¨åé¦ˆè‡ªå·±æ— æ³•å®Œæˆè¿™ä¸ªåŠ è½½è¯·æ±‚ï¼ˆå®ƒçš„æœç´¢èŒƒå›´ä¸­æ²¡æœ‰æ‰¾åˆ°æ‰€éœ€çš„ç±»ï¼‰æ—¶ï¼Œå­åŠ è½½å™¨æ‰ä¼šå°è¯•è‡ªå·±å»åŠ è½½ï¼ˆè°ƒç”¨è‡ªå·±çš„ <code>findClass()</code> æ–¹æ³•æ¥åŠ è½½ç±»ï¼‰ã€‚</li><li>å¦‚æœå­ç±»åŠ è½½å™¨ä¹Ÿæ— æ³•åŠ è½½è¿™ä¸ªç±»ï¼Œé‚£ä¹ˆå®ƒä¼šæŠ›å‡ºä¸€ä¸ª <code>ClassNotFoundException</code> å¼‚å¸¸ã€‚</li></ul><p>ğŸŒˆ æ‹“å±•ä¸€ä¸‹ï¼š</p><p><strong>JVM åˆ¤å®šä¸¤ä¸ª Java ç±»æ˜¯å¦ç›¸åŒçš„å…·ä½“è§„åˆ™</strong>ï¼šJVM ä¸ä»…è¦çœ‹ç±»çš„å…¨åæ˜¯å¦ç›¸åŒï¼Œè¿˜è¦çœ‹åŠ è½½æ­¤ç±»çš„ç±»åŠ è½½å™¨æ˜¯å¦ä¸€æ ·ã€‚åªæœ‰ä¸¤è€…éƒ½ç›¸åŒçš„æƒ…å†µï¼Œæ‰è®¤ä¸ºä¸¤ä¸ªç±»æ˜¯ç›¸åŒçš„ã€‚å³ä½¿ä¸¤ä¸ªç±»æ¥æºäºåŒä¸€ä¸ª <code>Class</code> æ–‡ä»¶ï¼Œè¢«åŒä¸€ä¸ªè™šæ‹ŸæœºåŠ è½½ï¼Œåªè¦åŠ è½½å®ƒä»¬çš„ç±»åŠ è½½å™¨ä¸åŒï¼Œé‚£è¿™ä¸¤ä¸ªç±»å°±å¿…å®šä¸ç›¸åŒã€‚</p><h3 id="åŒäº²å§”æ´¾æ¨¡å‹çš„å¥½å¤„" tabindex="-1"><a class="header-anchor" href="#åŒäº²å§”æ´¾æ¨¡å‹çš„å¥½å¤„"><span>åŒäº²å§”æ´¾æ¨¡å‹çš„å¥½å¤„</span></a></h3><p>åŒäº²å§”æ´¾æ¨¡å‹æ˜¯ Java ç±»åŠ è½½æœºåˆ¶çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå®ƒé€šè¿‡å§”æ´¾çˆ¶åŠ è½½å™¨ä¼˜å…ˆåŠ è½½ç±»çš„æ–¹å¼ï¼Œå®ç°äº†ä¸¤ä¸ªå…³é”®çš„å®‰å…¨ç›®æ ‡ï¼šé¿å…ç±»çš„é‡å¤åŠ è½½å’Œé˜²æ­¢æ ¸å¿ƒ API è¢«ç¯¡æ”¹ã€‚</p><p>JVM åŒºåˆ†ä¸åŒç±»çš„ä¾æ®æ˜¯ç±»ååŠ ä¸ŠåŠ è½½è¯¥ç±»çš„ç±»åŠ è½½å™¨ï¼Œå³ä½¿ç±»åç›¸åŒï¼Œå¦‚æœç”±ä¸åŒçš„ç±»åŠ è½½å™¨åŠ è½½ï¼Œä¹Ÿä¼šè¢«è§†ä¸ºä¸åŒçš„ç±»ã€‚ åŒäº²å§”æ´¾æ¨¡å‹ç¡®ä¿æ ¸å¿ƒç±»æ€»æ˜¯ç”± <code>BootstrapClassLoader</code> åŠ è½½ï¼Œä¿è¯äº†æ ¸å¿ƒç±»çš„å”¯ä¸€æ€§ã€‚</p><p>ä¾‹å¦‚ï¼Œå½“åº”ç”¨ç¨‹åºå°è¯•åŠ è½½ <code>java.lang.Object</code> æ—¶ï¼Œ<code>AppClassLoader</code> ä¼šé¦–å…ˆå°†è¯·æ±‚å§”æ´¾ç»™ <code>ExtClassLoader</code>ï¼Œ<code>ExtClassLoader</code> å†å§”æ´¾ç»™ <code>BootstrapClassLoader</code>ã€‚<code>BootstrapClassLoader</code> ä¼šåœ¨ JRE æ ¸å¿ƒç±»åº“ä¸­æ‰¾åˆ°å¹¶åŠ è½½ <code>java.lang.Object</code>ï¼Œä»è€Œä¿è¯åº”ç”¨ç¨‹åºä½¿ç”¨çš„æ˜¯ JRE æä¾›çš„æ ‡å‡†ç‰ˆæœ¬ã€‚</p><p>æœ‰å¾ˆå¤šå°ä¼™ä¼´å°±è¦è¯´äº†ï¼šâ€œé‚£æˆ‘ç»•è¿‡åŒäº²å§”æ´¾æ¨¡å‹ä¸å°±å¯ä»¥äº†ä¹ˆï¼Ÿâ€ã€‚</p><p>ç„¶è€Œï¼Œå³ä½¿æ”»å‡»è€…ç»•è¿‡äº†åŒäº²å§”æ´¾æ¨¡å‹ï¼ŒJava ä»ç„¶å…·å¤‡æ›´åº•å±‚çš„å®‰å…¨æœºåˆ¶æ¥ä¿æŠ¤æ ¸å¿ƒç±»åº“ã€‚<code>ClassLoader</code> çš„ <code>preDefineClass</code> æ–¹æ³•ä¼šåœ¨å®šä¹‰ç±»ä¹‹å‰è¿›è¡Œç±»åæ ¡éªŒã€‚ä»»ä½•ä»¥ <code>&quot;java.&quot;</code> å¼€å¤´çš„ç±»åéƒ½ä¼šè§¦å‘ <code>SecurityException</code>ï¼Œé˜»æ­¢æ¶æ„ä»£ç å®šä¹‰æˆ–åŠ è½½ä¼ªé€ çš„æ ¸å¿ƒç±»ã€‚</p><p>JDK 8 ä¸­<code>ClassLoader#preDefineClass</code> æ–¹æ³•æºç å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">private</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> ProtectionDomain</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> preDefineClass</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">                                            ProtectionDomain</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> pd)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        // æ£€æŸ¥ç±»åæ˜¯å¦åˆæ³•</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">checkName</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(name)) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            throw</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> NoClassDefFoundError</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;IllegalName: &quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> name)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        // é˜²æ­¢åœ¨ &quot;java.*&quot; åŒ…ä¸­å®šä¹‰ç±»ã€‚</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        // æ­¤æ£€æŸ¥å¯¹äºå®‰å…¨æ€§è‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒå¯ä»¥é˜²æ­¢æ¶æ„ä»£ç æ›¿æ¢æ ¸å¿ƒ Java ç±»ã€‚</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        // JDK 9 åˆ©ç”¨å¹³å°ç±»åŠ è½½å™¨å¢å¼ºäº† preDefineClass æ–¹æ³•çš„å®‰å…¨æ€§</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> ((name </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">) </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&amp;&amp;</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">startsWith</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;java.&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            throw</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> SecurityException</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">                (</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;ç¦æ­¢çš„åŒ…å: &quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">                 name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">substring</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lastIndexOf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;.&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         // å¦‚æœæœªæŒ‡å®š ProtectionDomainï¼Œåˆ™ä½¿ç”¨é»˜è®¤åŸŸï¼ˆdefaultDomainï¼‰ã€‚</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> (pd </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">            pd </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> defaultDomain</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> (name </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">            checkCerts</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> pd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getCodeSource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> pd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>JDK 9 ä¸­è¿™éƒ¨åˆ†é€»è¾‘æœ‰æ‰€æ”¹å˜ï¼Œå¤šäº†å¹³å°ç±»åŠ è½½å™¨ï¼ˆ<code>getPlatformClassLoader()</code> æ–¹æ³•è·å–ï¼‰ï¼Œå¢å¼ºäº† <code>preDefineClass</code> æ–¹æ³•çš„å®‰å…¨æ€§ã€‚è¿™é‡Œå°±ä¸è´´æºç äº†ï¼Œæ„Ÿå…´è¶£çš„è¯ï¼Œå¯ä»¥è‡ªå·±å»çœ‹çœ‹ã€‚</p><h3 id="æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹æ–¹æ³•"><span>æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹æ–¹æ³•</span></a></h3><p><s>ä¸ºäº†é¿å…åŒäº²å§”æ‰˜æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å®šä¹‰ä¸€ä¸ªç±»åŠ è½½å™¨ï¼Œç„¶åé‡å†™ <code>loadClass()</code> å³å¯ã€‚</s></p><p><strong>ğŸ› ä¿®æ­£ï¼ˆå‚è§ï¼š<a href="https://github.com/Snailclimb/JavaGuide/issues/871" target="_blank" rel="noopener noreferrer">issue871</a> ï¼‰</strong>ï¼šè‡ªå®šä¹‰åŠ è½½å™¨çš„è¯ï¼Œéœ€è¦ç»§æ‰¿ <code>ClassLoader</code> ã€‚å¦‚æœæˆ‘ä»¬ä¸æƒ³æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹ï¼Œå°±é‡å†™ <code>ClassLoader</code> ç±»ä¸­çš„ <code>findClass()</code> æ–¹æ³•å³å¯ï¼Œæ— æ³•è¢«çˆ¶ç±»åŠ è½½å™¨åŠ è½½çš„ç±»æœ€ç»ˆä¼šé€šè¿‡è¿™ä¸ªæ–¹æ³•è¢«åŠ è½½ã€‚ä½†æ˜¯ï¼Œå¦‚æœæƒ³æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹åˆ™éœ€è¦é‡å†™ <code>loadClass()</code> æ–¹æ³•ã€‚</p><p>ä¸ºä»€ä¹ˆæ˜¯é‡å†™ <code>loadClass()</code> æ–¹æ³•æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹å‘¢ï¼ŸåŒäº²å§”æ´¾æ¨¡å‹çš„æ‰§è¡Œæµç¨‹å·²ç»è§£é‡Šäº†ï¼š</p><blockquote><p>ç±»åŠ è½½å™¨åœ¨è¿›è¡Œç±»åŠ è½½çš„æ—¶å€™ï¼Œå®ƒé¦–å…ˆä¸ä¼šè‡ªå·±å»å°è¯•åŠ è½½è¿™ä¸ªç±»ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªè¯·æ±‚å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨å»å®Œæˆï¼ˆè°ƒç”¨çˆ¶åŠ è½½å™¨ <code>loadClass()</code>æ–¹æ³•æ¥åŠ è½½ç±»ï¼‰ã€‚</p></blockquote><p>é‡å†™ <code>loadClass()</code>æ–¹æ³•ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ”¹å˜ä¼ ç»ŸåŒäº²å§”æ´¾æ¨¡å‹çš„æ‰§è¡Œæµç¨‹ã€‚ä¾‹å¦‚ï¼Œå­ç±»åŠ è½½å™¨å¯ä»¥åœ¨å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨ä¹‹å‰ï¼Œå…ˆè‡ªå·±å°è¯•åŠ è½½è¿™ä¸ªç±»ï¼Œæˆ–è€…åœ¨çˆ¶ç±»åŠ è½½å™¨è¿”å›ä¹‹åï¼Œå†å°è¯•ä»å…¶ä»–åœ°æ–¹åŠ è½½è¿™ä¸ªç±»ã€‚å…·ä½“çš„è§„åˆ™ç”±æˆ‘ä»¬è‡ªå·±å®ç°ï¼Œæ ¹æ®é¡¹ç›®éœ€æ±‚å®šåˆ¶åŒ–ã€‚</p><p>æˆ‘ä»¬æ¯”è¾ƒç†Ÿæ‚‰çš„ Tomcat æœåŠ¡å™¨ä¸ºäº†èƒ½å¤Ÿä¼˜å…ˆåŠ è½½ Web åº”ç”¨ç›®å½•ä¸‹çš„ç±»ï¼Œç„¶åå†åŠ è½½å…¶ä»–ç›®å½•ä¸‹çš„ç±»ï¼Œå°±è‡ªå®šä¹‰äº†ç±»åŠ è½½å™¨ <code>WebAppClassLoader</code> æ¥æ‰“ç ´åŒäº²å§”æ‰˜æœºåˆ¶ã€‚è¿™ä¹Ÿæ˜¯ Tomcat ä¸‹ Web åº”ç”¨ä¹‹é—´çš„ç±»å®ç°éš”ç¦»çš„å…·ä½“åŸç†ã€‚</p><p>Tomcat çš„ç±»åŠ è½½å™¨çš„å±‚æ¬¡ç»“æ„å¦‚ä¸‹ï¼š</p><p><img src="https://oss.javaguide.cn/github/javaguide/java/jvm/tomcat-class-loader-parents-delegation-model.png" alt="Tomcat çš„ç±»åŠ è½½å™¨çš„å±‚æ¬¡ç»“æ„"></p><p>Tomcat è¿™å››ä¸ªè‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨å¯¹åº”çš„ç›®å½•å¦‚ä¸‹ï¼š</p><ul><li><code>CommonClassLoader</code>å¯¹åº”<code>&lt;Tomcat&gt;/common/*</code></li><li><code>CatalinaClassLoader</code>å¯¹åº”<code>&lt;Tomcat &gt;/server/*</code></li><li><code>SharedClassLoader</code>å¯¹åº” <code>&lt;Tomcat &gt;/shared/*</code></li><li><code>WebAppClassloader</code>å¯¹åº” <code>&lt;Tomcat &gt;/webapps/&lt;app&gt;/WEB-INF/*</code></li></ul><p>ä»å›¾ä¸­çš„å§”æ´¾å…³ç³»ä¸­å¯ä»¥çœ‹å‡ºï¼š</p><ul><li><code>CommonClassLoader</code>ä½œä¸º <code>CatalinaClassLoader</code> å’Œ <code>SharedClassLoader</code> çš„çˆ¶åŠ è½½å™¨ã€‚<code>CommonClassLoader</code> èƒ½åŠ è½½çš„ç±»éƒ½å¯ä»¥è¢« <code>CatalinaClassLoader</code> å’Œ <code>SharedClassLoader</code> ä½¿ç”¨ã€‚å› æ­¤ï¼Œ<code>CommonClassLoader</code> æ˜¯ä¸ºäº†å®ç°å…¬å…±ç±»åº“ï¼ˆå¯ä»¥è¢«æ‰€æœ‰ Web åº”ç”¨å’Œ Tomcat å†…éƒ¨ç»„ä»¶ä½¿ç”¨çš„ç±»åº“ï¼‰çš„å…±äº«å’Œéš”ç¦»ã€‚</li><li><code>CatalinaClassLoader</code> å’Œ <code>SharedClassLoader</code> èƒ½åŠ è½½çš„ç±»åˆ™ä¸å¯¹æ–¹ç›¸äº’éš”ç¦»ã€‚<code>CatalinaClassLoader</code> ç”¨äºåŠ è½½ Tomcat è‡ªèº«çš„ç±»ï¼Œä¸ºäº†éš”ç¦» Tomcat æœ¬èº«çš„ç±»å’Œ Web åº”ç”¨çš„ç±»ã€‚<code>SharedClassLoader</code> ä½œä¸º <code>WebAppClassLoader</code> çš„çˆ¶åŠ è½½å™¨ï¼Œä¸“é—¨æ¥åŠ è½½ Web åº”ç”¨ä¹‹é—´å…±äº«çš„ç±»æ¯”å¦‚ Springã€Mybatisã€‚</li><li>æ¯ä¸ª Web åº”ç”¨éƒ½ä¼šåˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ <code>WebAppClassLoader</code>ï¼Œå¹¶åœ¨å¯åŠ¨ Web åº”ç”¨çš„çº¿ç¨‹é‡Œè®¾ç½®çº¿ç¨‹çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ä¸º <code>WebAppClassLoader</code>ã€‚å„ä¸ª <code>WebAppClassLoader</code> å®ä¾‹ä¹‹é—´ç›¸äº’éš”ç¦»ï¼Œè¿›è€Œå®ç° Web åº”ç”¨ä¹‹é—´çš„ç±»éš”ã€‚</li></ul><p>å•çº¯ä¾é è‡ªå®šä¹‰ç±»åŠ è½½å™¨æ²¡åŠæ³•æ»¡è¶³æŸäº›åœºæ™¯çš„è¦æ±‚ï¼Œä¾‹å¦‚ï¼Œæœ‰äº›æƒ…å†µä¸‹ï¼Œé«˜å±‚çš„ç±»åŠ è½½å™¨éœ€è¦åŠ è½½ä½å±‚çš„åŠ è½½å™¨æ‰èƒ½åŠ è½½çš„ç±»ã€‚</p><p>æ¯”å¦‚ï¼ŒSPI ä¸­ï¼ŒSPI çš„æ¥å£ï¼ˆå¦‚ <code>java.sql.Driver</code>ï¼‰æ˜¯ç”± Java æ ¸å¿ƒåº“æä¾›çš„ï¼Œç”±<code>BootstrapClassLoader</code> åŠ è½½ã€‚è€Œ SPI çš„å®ç°ï¼ˆå¦‚<code>com.mysql.cj.jdbc.Driver</code>ï¼‰æ˜¯ç”±ç¬¬ä¸‰æ–¹ä¾›åº”å•†æä¾›çš„ï¼Œå®ƒä»¬æ˜¯ç”±åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨æˆ–è€…è‡ªå®šä¹‰ç±»åŠ è½½å™¨æ¥åŠ è½½çš„ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€ä¸ªç±»åŠå…¶ä¾èµ–ç±»ç”±åŒä¸€ä¸ªç±»åŠ è½½å™¨åŠ è½½ã€‚æ‰€ä»¥ï¼ŒåŠ è½½ SPI çš„æ¥å£çš„ç±»åŠ è½½å™¨ï¼ˆ<code>BootstrapClassLoader</code>ï¼‰ä¹Ÿä¼šç”¨æ¥åŠ è½½ SPI çš„å®ç°ã€‚æŒ‰ç…§åŒäº²å§”æ´¾æ¨¡å‹ï¼Œ<code>BootstrapClassLoader</code> æ˜¯æ— æ³•æ‰¾åˆ° SPI çš„å®ç°ç±»çš„ï¼Œå› ä¸ºå®ƒæ— æ³•å§”æ‰˜ç»™å­ç±»åŠ è½½å™¨å»å°è¯•åŠ è½½ã€‚</p><p>å†æ¯”å¦‚ï¼Œå‡è®¾æˆ‘ä»¬çš„é¡¹ç›®ä¸­æœ‰ Spring çš„ jar åŒ…ï¼Œç”±äºå…¶æ˜¯ Web åº”ç”¨ä¹‹é—´å…±äº«çš„ï¼Œå› æ­¤ä¼šç”± <code>SharedClassLoader</code> åŠ è½½ï¼ˆWeb æœåŠ¡å™¨æ˜¯ Tomcatï¼‰ã€‚æˆ‘ä»¬é¡¹ç›®ä¸­æœ‰ä¸€äº›ç”¨åˆ°äº† Spring çš„ä¸šåŠ¡ç±»ï¼Œæ¯”å¦‚å®ç°äº† Spring æä¾›çš„æ¥å£ã€ç”¨åˆ°äº† Spring æä¾›çš„æ³¨è§£ã€‚æ‰€ä»¥ï¼ŒåŠ è½½ Spring çš„ç±»åŠ è½½å™¨ï¼ˆä¹Ÿå°±æ˜¯ <code>SharedClassLoader</code>ï¼‰ä¹Ÿä¼šç”¨æ¥åŠ è½½è¿™äº›ä¸šåŠ¡ç±»ã€‚ä½†æ˜¯ä¸šåŠ¡ç±»åœ¨ Web åº”ç”¨ç›®å½•ä¸‹ï¼Œä¸åœ¨ <code>SharedClassLoader</code> çš„åŠ è½½è·¯å¾„ä¸‹ï¼Œæ‰€ä»¥ <code>SharedClassLoader</code> æ— æ³•æ‰¾åˆ°ä¸šåŠ¡ç±»ï¼Œä¹Ÿå°±æ— æ³•åŠ è½½å®ƒä»¬ã€‚</p><p>å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ è¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ° <strong>çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼ˆ<code>ThreadContextClassLoader</code>ï¼‰</strong> äº†ã€‚</p><p>æ‹¿ Spring è¿™ä¸ªä¾‹å­æ¥è¯´ï¼Œå½“ Spring éœ€è¦åŠ è½½ä¸šåŠ¡ç±»çš„æ—¶å€™ï¼Œå®ƒä¸æ˜¯ç”¨è‡ªå·±çš„ç±»åŠ è½½å™¨ï¼Œè€Œæ˜¯ç”¨å½“å‰çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ã€‚è¿˜è®°å¾—æˆ‘ä¸Šé¢è¯´çš„å—ï¼Ÿæ¯ä¸ª Web åº”ç”¨éƒ½ä¼šåˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ <code>WebAppClassLoader</code>ï¼Œå¹¶åœ¨å¯åŠ¨ Web åº”ç”¨çš„çº¿ç¨‹é‡Œè®¾ç½®çº¿ç¨‹çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ä¸º <code>WebAppClassLoader</code>ã€‚è¿™æ ·å°±å¯ä»¥è®©é«˜å±‚çš„ç±»åŠ è½½å™¨ï¼ˆ<code>SharedClassLoader</code>ï¼‰å€ŸåŠ©å­ç±»åŠ è½½å™¨ï¼ˆ <code>WebAppClassLoader</code>ï¼‰æ¥åŠ è½½ä¸šåŠ¡ç±»ï¼Œç ´åäº† Java çš„ç±»åŠ è½½å§”æ‰˜æœºåˆ¶ï¼Œè®©åº”ç”¨é€†å‘ä½¿ç”¨ç±»åŠ è½½å™¨ã€‚</p><p>çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨çš„åŸç†æ˜¯å°†ä¸€ä¸ªç±»åŠ è½½å™¨ä¿å­˜åœ¨çº¿ç¨‹ç§æœ‰æ•°æ®é‡Œï¼Œè·Ÿçº¿ç¨‹ç»‘å®šï¼Œç„¶ååœ¨éœ€è¦çš„æ—¶å€™å–å‡ºæ¥ä½¿ç”¨ã€‚è¿™ä¸ªç±»åŠ è½½å™¨é€šå¸¸æ˜¯ç”±åº”ç”¨ç¨‹åºæˆ–è€…å®¹å™¨ï¼ˆå¦‚ Tomcatï¼‰è®¾ç½®çš„ã€‚</p><p><code>Java.lang.Thread</code> ä¸­çš„<code>getContextClassLoader()</code>å’Œ <code>setContextClassLoader(ClassLoader cl)</code>åˆ†åˆ«ç”¨æ¥è·å–å’Œè®¾ç½®çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ã€‚å¦‚æœæ²¡æœ‰é€šè¿‡<code>setContextClassLoader(ClassLoader cl)</code>è¿›è¡Œè®¾ç½®çš„è¯ï¼Œçº¿ç¨‹å°†ç»§æ‰¿å…¶çˆ¶çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ã€‚</p><p>Spring è·å–çº¿ç¨‹çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨çš„ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">cl </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> Thread</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">currentThread</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getContextClassLoader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æ„Ÿå…´è¶£çš„å°ä¼™ä¼´å¯ä»¥è‡ªè¡Œæ·±å…¥ç ”ç©¶ä¸€ä¸‹ Tomcat æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹çš„åŸç†ï¼Œæ¨èèµ„æ–™ï¼š<a href="http://gk.link/a/10Egr" target="_blank" rel="noopener noreferrer">ã€Šæ·±å…¥æ‹†è§£ Tomcat &amp; Jettyã€‹</a>ã€‚</p><h2 id="æ¨èé˜…è¯»" tabindex="-1"><a class="header-anchor" href="#æ¨èé˜…è¯»"><span>æ¨èé˜…è¯»</span></a></h2><ul><li>ã€Šæ·±å…¥æ‹†è§£ Java è™šæ‹Ÿæœºã€‹</li><li>æ·±å…¥åˆ†æ Java ClassLoader åŸç†ï¼š<a href="https://blog.csdn.net/xyang81/article/details/7292380" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/xyang81/article/details/7292380</a></li><li>Java ç±»åŠ è½½å™¨(ClassLoader)ï¼š<a href="http://gityuan.com/2016/01/24/java-classloader/" target="_blank" rel="noopener noreferrer">http://gityuan.com/2016/01/24/java-classloader/</a></li><li>Class Loaders in Javaï¼š<a href="https://www.baeldung.com/java-classloaders" target="_blank" rel="noopener noreferrer">https://www.baeldung.com/java-classloaders</a></li><li>Class ClassLoader - Oracle å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/ClassLoader.html" target="_blank" rel="noopener noreferrer">https://docs.oracle.com/javase/8/docs/api/java/lang/ClassLoader.html</a></li><li>è€å¤§éš¾çš„ Java ClassLoader å†ä¸ç†è§£å°±è€äº†ï¼š<a href="https://zhuanlan.zhihu.com/p/51374915" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/51374915</a></li></ul><p><img src="https://oss.javaguide.cn/github/javaguide/gongzhonghaoxuanchuan.png" alt="JavaGuide å®˜æ–¹å…¬ä¼—å·"></p>`,104)]))}const k=i(n,[["render",t],["__file","classloader.html.vue"]]),r=JSON.parse('{"path":"/java/jvm/classloader.html","title":"ç±»åŠ è½½å™¨è¯¦è§£ï¼ˆé‡ç‚¹ï¼‰","lang":"zh-CN","frontmatter":{"title":"ç±»åŠ è½½å™¨è¯¦è§£ï¼ˆé‡ç‚¹ï¼‰","category":"Java","tag":["JVM"],"description":"å›é¡¾ä¸€ä¸‹ç±»åŠ è½½è¿‡ç¨‹ å¼€å§‹ä»‹ç»ç±»åŠ è½½å™¨å’ŒåŒäº²å§”æ´¾æ¨¡å‹ä¹‹å‰ï¼Œç®€å•å›é¡¾ä¸€ä¸‹ç±»åŠ è½½è¿‡ç¨‹ã€‚ ç±»åŠ è½½è¿‡ç¨‹ï¼šåŠ è½½->è¿æ¥->åˆå§‹åŒ–ã€‚ è¿æ¥è¿‡ç¨‹åˆå¯åˆ†ä¸ºä¸‰æ­¥ï¼šéªŒè¯->å‡†å¤‡->è§£æã€‚ ç±»åŠ è½½è¿‡ç¨‹ åŠ è½½æ˜¯ç±»åŠ è½½è¿‡ç¨‹çš„ç¬¬ä¸€æ­¥ï¼Œä¸»è¦å®Œæˆä¸‹é¢ 3 ä»¶äº‹æƒ…ï¼š é€šè¿‡å…¨ç±»åè·å–å®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµ å°†å­—èŠ‚æµæ‰€ä»£è¡¨çš„é™æ€å­˜å‚¨ç»“æ„è½¬æ¢ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„ åœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¯¥ç±»çš„...","head":[["meta",{"property":"og:url","content":"https://javaguide.cn/java/jvm/classloader.html"}],["meta",{"property":"og:site_name","content":"JavaGuide"}],["meta",{"property":"og:title","content":"ç±»åŠ è½½å™¨è¯¦è§£ï¼ˆé‡ç‚¹ï¼‰"}],["meta",{"property":"og:description","content":"å›é¡¾ä¸€ä¸‹ç±»åŠ è½½è¿‡ç¨‹ å¼€å§‹ä»‹ç»ç±»åŠ è½½å™¨å’ŒåŒäº²å§”æ´¾æ¨¡å‹ä¹‹å‰ï¼Œç®€å•å›é¡¾ä¸€ä¸‹ç±»åŠ è½½è¿‡ç¨‹ã€‚ ç±»åŠ è½½è¿‡ç¨‹ï¼šåŠ è½½->è¿æ¥->åˆå§‹åŒ–ã€‚ è¿æ¥è¿‡ç¨‹åˆå¯åˆ†ä¸ºä¸‰æ­¥ï¼šéªŒè¯->å‡†å¤‡->è§£æã€‚ ç±»åŠ è½½è¿‡ç¨‹ åŠ è½½æ˜¯ç±»åŠ è½½è¿‡ç¨‹çš„ç¬¬ä¸€æ­¥ï¼Œä¸»è¦å®Œæˆä¸‹é¢ 3 ä»¶äº‹æƒ…ï¼š é€šè¿‡å…¨ç±»åè·å–å®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµ å°†å­—èŠ‚æµæ‰€ä»£è¡¨çš„é™æ€å­˜å‚¨ç»“æ„è½¬æ¢ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„ åœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¯¥ç±»çš„..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://oss.javaguide.cn/github/javaguide/java/jvm/class-loading-procedure.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-06-22T03:45:21.000Z"}],["meta",{"property":"article:tag","content":"JVM"}],["meta",{"property":"article:modified_time","content":"2025-06-22T03:45:21.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"ç±»åŠ è½½å™¨è¯¦è§£ï¼ˆé‡ç‚¹ï¼‰\\",\\"image\\":[\\"https://oss.javaguide.cn/github/javaguide/java/jvm/class-loading-procedure.png\\",\\"https://oss.javaguide.cn/github/javaguide/java/jvm/class-loader-parents-delegation-model.png\\",\\"https://oss.javaguide.cn/github/javaguide/java/jvm/class-loader-parents-delegation-model.png\\",\\"https://oss.javaguide.cn/github/javaguide/java/jvm/tomcat-class-loader-parents-delegation-model.png\\"],\\"dateModified\\":\\"2025-06-22T03:45:21.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Guide\\",\\"url\\":\\"https://javaguide.cn/article/\\"}]}"]]},"headers":[{"level":2,"title":"å›é¡¾ä¸€ä¸‹ç±»åŠ è½½è¿‡ç¨‹","slug":"å›é¡¾ä¸€ä¸‹ç±»åŠ è½½è¿‡ç¨‹","link":"#å›é¡¾ä¸€ä¸‹ç±»åŠ è½½è¿‡ç¨‹","children":[]},{"level":2,"title":"ç±»åŠ è½½å™¨","slug":"ç±»åŠ è½½å™¨","link":"#ç±»åŠ è½½å™¨","children":[{"level":3,"title":"ç±»åŠ è½½å™¨ä»‹ç»","slug":"ç±»åŠ è½½å™¨ä»‹ç»","link":"#ç±»åŠ è½½å™¨ä»‹ç»","children":[]},{"level":3,"title":"ç±»åŠ è½½å™¨åŠ è½½è§„åˆ™","slug":"ç±»åŠ è½½å™¨åŠ è½½è§„åˆ™","link":"#ç±»åŠ è½½å™¨åŠ è½½è§„åˆ™","children":[]},{"level":3,"title":"ç±»åŠ è½½å™¨æ€»ç»“","slug":"ç±»åŠ è½½å™¨æ€»ç»“","link":"#ç±»åŠ è½½å™¨æ€»ç»“","children":[]},{"level":3,"title":"è‡ªå®šä¹‰ç±»åŠ è½½å™¨","slug":"è‡ªå®šä¹‰ç±»åŠ è½½å™¨","link":"#è‡ªå®šä¹‰ç±»åŠ è½½å™¨","children":[]}]},{"level":2,"title":"åŒäº²å§”æ´¾æ¨¡å‹","slug":"åŒäº²å§”æ´¾æ¨¡å‹","link":"#åŒäº²å§”æ´¾æ¨¡å‹","children":[{"level":3,"title":"åŒäº²å§”æ´¾æ¨¡å‹ä»‹ç»","slug":"åŒäº²å§”æ´¾æ¨¡å‹ä»‹ç»","link":"#åŒäº²å§”æ´¾æ¨¡å‹ä»‹ç»","children":[]},{"level":3,"title":"åŒäº²å§”æ´¾æ¨¡å‹çš„æ‰§è¡Œæµç¨‹","slug":"åŒäº²å§”æ´¾æ¨¡å‹çš„æ‰§è¡Œæµç¨‹","link":"#åŒäº²å§”æ´¾æ¨¡å‹çš„æ‰§è¡Œæµç¨‹","children":[]},{"level":3,"title":"åŒäº²å§”æ´¾æ¨¡å‹çš„å¥½å¤„","slug":"åŒäº²å§”æ´¾æ¨¡å‹çš„å¥½å¤„","link":"#åŒäº²å§”æ´¾æ¨¡å‹çš„å¥½å¤„","children":[]},{"level":3,"title":"æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹æ–¹æ³•","slug":"æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹æ–¹æ³•","link":"#æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹æ–¹æ³•","children":[]}]},{"level":2,"title":"æ¨èé˜…è¯»","slug":"æ¨èé˜…è¯»","link":"#æ¨èé˜…è¯»","children":[]}],"git":{"createdTime":1750563921000,"updatedTime":1750563921000,"contributors":[{"name":"DanlionYou","username":"DanlionYou","email":"3184877618.com","commits":1,"url":"https://github.com/DanlionYou"}]},"readingTime":{"minutes":18.14,"words":5442},"filePathRelative":"java/jvm/classloader.md","localizedDate":"2025å¹´6æœˆ22æ—¥","excerpt":"<h2>å›é¡¾ä¸€ä¸‹ç±»åŠ è½½è¿‡ç¨‹</h2>\\n<p>å¼€å§‹ä»‹ç»ç±»åŠ è½½å™¨å’ŒåŒäº²å§”æ´¾æ¨¡å‹ä¹‹å‰ï¼Œç®€å•å›é¡¾ä¸€ä¸‹ç±»åŠ è½½è¿‡ç¨‹ã€‚</p>\\n<ul>\\n<li>ç±»åŠ è½½è¿‡ç¨‹ï¼š<strong>åŠ è½½-&gt;è¿æ¥-&gt;åˆå§‹åŒ–</strong>ã€‚</li>\\n<li>è¿æ¥è¿‡ç¨‹åˆå¯åˆ†ä¸ºä¸‰æ­¥ï¼š<strong>éªŒè¯-&gt;å‡†å¤‡-&gt;è§£æ</strong>ã€‚</li>\\n</ul>\\n<p><img src=\\"https://oss.javaguide.cn/github/javaguide/java/jvm/class-loading-procedure.png\\" alt=\\"ç±»åŠ è½½è¿‡ç¨‹\\"></p>\\n<p>åŠ è½½æ˜¯ç±»åŠ è½½è¿‡ç¨‹çš„ç¬¬ä¸€æ­¥ï¼Œä¸»è¦å®Œæˆä¸‹é¢ 3 ä»¶äº‹æƒ…ï¼š</p>","autoDesc":true}');export{k as comp,r as data};
